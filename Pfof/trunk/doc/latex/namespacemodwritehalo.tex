\hypertarget{namespacemodwritehalo}{}\section{modwritehalo Module Reference}
\label{namespacemodwritehalo}\index{modwritehalo@{modwritehalo}}


This module contains routines to write H\+D\+F5 halo files created with pfof and pfof\+\_\+cone.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespacemodwritehalo_a3e00317bab6230ca8987e14b62b79874}{h5writehalopart} (param\+\_\+pfof, halo\+NB, halopart\+NB, halo\+Mass, halo\+ID, halopart\+Pos, halopart\+Vel, halopart\+ID, halopart\+For, halopart\+Pot, halopart\+Ramses\+ID, inforamses, infocone)
\begin{DoxyCompactList}\small\item\em This subroutine writes for each halo the position, the velocity and the id of each particle in this halo in a hdf5 file. One file is written per M\+PI process and several halos per file. There is one group per halo, the name of the group is the ID of the halo. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacemodwritehalo_a7de4785bb81feb8a4b806bd18a65bf4d}{mpih5writehalopart} (mpicomm, param\+\_\+pfof, halo\+NB, halopart\+NB, halo\+Mass, halo\+ID, halopart\+Pos, halopart\+Vel, halopart\+ID, halopart\+For, halopart\+Pot, halopart\+Ramses\+ID, inforamses, infocone)
\begin{DoxyCompactList}\small\item\em This subroutine writes for each halo the position, the velocity and the id of each particle in this halo in a hdf5 file. One file is written per M\+PI communicator mpicomm and several halos per file, using parallel H\+D\+F5. There is one group per halo, the name of the group is the ID of the halo. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacemodwritehalo_a9f9dfc9671a5f395219212ba8d45204b}{mpih5writehalomass} (mpicomm, param\+\_\+pfof, halo\+N\+B\+\_\+all, halo\+NB, nh, halo\+Mass, halocom\+Pos, halocom\+Vel, halo\+ID, halo\+Radius, halo\+Sub\+Halo\+NB, inforamses, infocone)
\begin{DoxyCompactList}\small\item\em This subroutine writes, for each halo, its mass (number of particles), the position and the velocity of its center of mass and its ID in only one hdf5 file using parallel H\+D\+F5. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This module contains routines to write H\+D\+F5 halo files created with pfof and pfof\+\_\+cone. 

\begin{DoxyAuthor}{Author}
Fabrice Roy 
\end{DoxyAuthor}


\subsection{Function/\+Subroutine Documentation}
\index{modwritehalo@{modwritehalo}!h5writehalopart@{h5writehalopart}}
\index{h5writehalopart@{h5writehalopart}!modwritehalo@{modwritehalo}}
\subsubsection[{\texorpdfstring{h5writehalopart(param\+\_\+pfof, halo\+N\+B, halopart\+N\+B, halo\+Mass, halo\+I\+D, halopart\+Pos, halopart\+Vel, halopart\+I\+D, halopart\+For, halopart\+Pot, halopart\+Ramses\+I\+D, inforamses, infocone)}{h5writehalopart(param_pfof, haloNB, halopartNB, haloMass, haloID, halopartPos, halopartVel, halopartID, halopartFor, halopartPot, halopartRamsesID, inforamses, infocone)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine modwritehalo\+::h5writehalopart (
\begin{DoxyParamCaption}
\item[{class({\bf type\+\_\+parameter\+\_\+pfof}), intent(in)}]{param\+\_\+pfof, }
\item[{integer(kind=4), intent(in)}]{halo\+NB, }
\item[{integer(kind=4), intent(in)}]{halopart\+NB, }
\item[{integer(kind=4), dimension(halonb), intent(in)}]{halo\+Mass, }
\item[{integer(kind=pri), dimension(halonb), intent(in)}]{halo\+ID, }
\item[{real (kind=4), dimension(3,halopartnb), intent(in), target}]{halopart\+Pos, }
\item[{real (kind=4), dimension(3,halopartnb), intent(in), target}]{halopart\+Vel, }
\item[{integer(kind=pri), dimension(halopartnb), intent(in), target}]{halopart\+ID, }
\item[{real (kind=4), dimension(3,halopartnb), intent(in), optional, target}]{halopart\+For, }
\item[{real (kind=4), dimension(halopartnb), intent(in), optional, target}]{halopart\+Pot, }
\item[{integer(kind=pri), dimension(halopartnb), intent(in), optional, target}]{halopart\+Ramses\+ID, }
\item[{type({\bf type\+\_\+inforamses}), intent(in)}]{inforamses, }
\item[{class({\bf type\+\_\+infocone}), intent(in), optional}]{infocone}
\end{DoxyParamCaption}
)}\hypertarget{namespacemodwritehalo_a3e00317bab6230ca8987e14b62b79874}{}\label{namespacemodwritehalo_a3e00317bab6230ca8987e14b62b79874}


This subroutine writes for each halo the position, the velocity and the id of each particle in this halo in a hdf5 file. One file is written per M\+PI process and several halos per file. There is one group per halo, the name of the group is the ID of the halo. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em halonb} & Number of halos\\
\hline
\mbox{\tt in}  & {\em halopartnb} & Number of particles belonging to the halos\\
\hline
\mbox{\tt in}  & {\em haloid} & Array containing the ID of the halos\\
\hline
\mbox{\tt in}  & {\em halopartid} & Array containing the ID of the particles belonging to the halos\\
\hline
\mbox{\tt in}  & {\em halomass} & Array containing the mass of the halos\\
\hline
\mbox{\tt in}  & {\em halopartvel} & Array containing the position and velocity of the particles belonging to the halos\\
\hline
\mbox{\tt in}  & {\em halopartpot} & Array containing the potential of the particles belonging to the halos, this argument is optional\\
\hline
\mbox{\tt in}  & {\em halopartfor} & Array containing the force on the particles belonging to the halos, this argument is optional\\
\hline
\mbox{\tt in}  & {\em halopartramsesid} & Array containing the \char`\"{}\+Ramses\char`\"{} ID of the particles belonging to the halos detected in lightcones \\
\hline
\end{DoxyParams}


Definition at line 24 of file modwritehalo.\+f90.



References modiocommons\+::h5write\+\_\+meta\+\_\+common(), modiocommons\+::h5write\+\_\+meta\+\_\+info\+\_\+cone(), modiocommons\+::h5write\+\_\+meta\+\_\+info\+\_\+ramses(), modiocommons\+::h5write\+\_\+meta\+\_\+pfof\+\_\+parameter(), modhdf5\+::hdf5\+\_\+close\+\_\+file(), modhdf5\+::hdf5\+\_\+close\+\_\+group(), modhdf5\+::hdf5\+\_\+create\+\_\+file(), modhdf5\+::hdf5\+\_\+create\+\_\+group(), modhdf5\+::hdf5\+\_\+open\+\_\+group(), modmpicom\+::procid, and modmpicom\+::procnb.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemodwritehalo_a3e00317bab6230ca8987e14b62b79874_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemodwritehalo_a3e00317bab6230ca8987e14b62b79874_icgraph}
\end{center}
\end{figure}


\index{modwritehalo@{modwritehalo}!mpih5writehalomass@{mpih5writehalomass}}
\index{mpih5writehalomass@{mpih5writehalomass}!modwritehalo@{modwritehalo}}
\subsubsection[{\texorpdfstring{mpih5writehalomass(mpicomm, param\+\_\+pfof, halo\+N\+B\+\_\+all, halo\+N\+B, nh, halo\+Mass, halocom\+Pos, halocom\+Vel, halo\+I\+D, halo\+Radius, halo\+Sub\+Halo\+N\+B, inforamses, infocone)}{mpih5writehalomass(mpicomm, param_pfof, haloNB_all, haloNB, nh, haloMass, halocomPos, halocomVel, haloID, haloRadius, haloSubHaloNB, inforamses, infocone)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine modwritehalo\+::mpih5writehalomass (
\begin{DoxyParamCaption}
\item[{integer(kind=4), intent(in)}]{mpicomm, }
\item[{class({\bf type\+\_\+parameter\+\_\+pfof}), intent(in)}]{param\+\_\+pfof, }
\item[{integer(kind=4), intent(in)}]{halo\+N\+B\+\_\+all, }
\item[{integer(kind=4), intent(in)}]{halo\+NB, }
\item[{integer(kind=4), intent(in)}]{nh, }
\item[{integer(kind=4), dimension(nh), intent(in), target}]{halo\+Mass, }
\item[{real(kind=8), dimension(3,nh), intent(in), target}]{halocom\+Pos, }
\item[{real(kind=8), dimension(3,nh), intent(in), target}]{halocom\+Vel, }
\item[{integer(kind=pri), dimension(nh), intent(in), target}]{halo\+ID, }
\item[{real(kind=8), dimension(nh), intent(in), target}]{halo\+Radius, }
\item[{integer(kind=4), dimension(nh), intent(in), target}]{halo\+Sub\+Halo\+NB, }
\item[{type({\bf type\+\_\+inforamses}), intent(in)}]{inforamses, }
\item[{class({\bf type\+\_\+infocone}), intent(in), optional}]{infocone}
\end{DoxyParamCaption}
)}\hypertarget{namespacemodwritehalo_a9f9dfc9671a5f395219212ba8d45204b}{}\label{namespacemodwritehalo_a9f9dfc9671a5f395219212ba8d45204b}


This subroutine writes, for each halo, its mass (number of particles), the position and the velocity of its center of mass and its ID in only one hdf5 file using parallel H\+D\+F5. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em halonb\+\_\+all} & Total number of halos (sum over all processes)\\
\hline
\mbox{\tt in}  & {\em halonb} & Number of halos\\
\hline
\mbox{\tt in}  & {\em halomass} & Mass of the halos\\
\hline
\mbox{\tt in}  & {\em halocompos} & Position of the center of mass of the halos\\
\hline
\mbox{\tt in}  & {\em halocomvel} & Velocity of the center of mass of the halos\\
\hline
\mbox{\tt in}  & {\em haloid} & ID of the halos\\
\hline
\mbox{\tt in}  & {\em haloradius} & Radius of the halos\\
\hline
\mbox{\tt in}  & {\em halosubhalonb} & Number of subhalos in each halo\\
\hline
\mbox{\tt in}  & {\em mpicomm} & M\+PI communicator used to create and write the file \\
\hline
\end{DoxyParams}


Definition at line 503 of file modwritehalo.\+f90.



References modiocommons\+::h5write\+\_\+meta\+\_\+common(), modiocommons\+::h5write\+\_\+meta\+\_\+info\+\_\+cone(), modiocommons\+::h5write\+\_\+meta\+\_\+info\+\_\+ramses(), modiocommons\+::h5write\+\_\+meta\+\_\+pfof\+\_\+parameter(), modhdf5\+::hdf5\+\_\+create\+\_\+mpi\+\_\+file(), modhdf5\+::hdf5\+\_\+open\+\_\+group(), and modmpicom\+::procid.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemodwritehalo_a9f9dfc9671a5f395219212ba8d45204b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemodwritehalo_a9f9dfc9671a5f395219212ba8d45204b_icgraph}
\end{center}
\end{figure}


\index{modwritehalo@{modwritehalo}!mpih5writehalopart@{mpih5writehalopart}}
\index{mpih5writehalopart@{mpih5writehalopart}!modwritehalo@{modwritehalo}}
\subsubsection[{\texorpdfstring{mpih5writehalopart(mpicomm, param\+\_\+pfof, halo\+N\+B, halopart\+N\+B, halo\+Mass, halo\+I\+D, halopart\+Pos, halopart\+Vel, halopart\+I\+D, halopart\+For, halopart\+Pot, halopart\+Ramses\+I\+D, inforamses, infocone)}{mpih5writehalopart(mpicomm, param_pfof, haloNB, halopartNB, haloMass, haloID, halopartPos, halopartVel, halopartID, halopartFor, halopartPot, halopartRamsesID, inforamses, infocone)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine modwritehalo\+::mpih5writehalopart (
\begin{DoxyParamCaption}
\item[{integer(kind=4), intent(in)}]{mpicomm, }
\item[{class({\bf type\+\_\+parameter\+\_\+pfof}), intent(in)}]{param\+\_\+pfof, }
\item[{integer(kind=4), intent(in)}]{halo\+NB, }
\item[{integer(kind=4), intent(in)}]{halopart\+NB, }
\item[{integer(kind=4), dimension(halonb), intent(in)}]{halo\+Mass, }
\item[{integer(kind=pri), dimension(halonb), intent(in)}]{halo\+ID, }
\item[{real (kind=4), dimension(3,halopartnb), intent(in), target}]{halopart\+Pos, }
\item[{real (kind=4), dimension(3,halopartnb), intent(in), target}]{halopart\+Vel, }
\item[{integer(kind=pri), dimension(halopartnb), intent(in), target}]{halopart\+ID, }
\item[{real (kind=4), dimension(3,halopartnb), intent(in), optional, target}]{halopart\+For, }
\item[{real (kind=4), dimension(halopartnb), intent(in), optional, target}]{halopart\+Pot, }
\item[{integer(kind=pri), dimension(halopartnb), intent(in), optional, target}]{halopart\+Ramses\+ID, }
\item[{type({\bf type\+\_\+inforamses}), intent(in)}]{inforamses, }
\item[{class({\bf type\+\_\+infocone}), intent(in), optional}]{infocone}
\end{DoxyParamCaption}
)}\hypertarget{namespacemodwritehalo_a7de4785bb81feb8a4b806bd18a65bf4d}{}\label{namespacemodwritehalo_a7de4785bb81feb8a4b806bd18a65bf4d}


This subroutine writes for each halo the position, the velocity and the id of each particle in this halo in a hdf5 file. One file is written per M\+PI communicator mpicomm and several halos per file, using parallel H\+D\+F5. There is one group per halo, the name of the group is the ID of the halo. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mpicomm} & M\+PI communicator used to gather informations\\
\hline
\mbox{\tt in}  & {\em halonb} & Number of halos\\
\hline
\mbox{\tt in}  & {\em halopartnb} & Number of particles belonging to the halos\\
\hline
\mbox{\tt in}  & {\em haloid} & Array containing the ID of the halos\\
\hline
\mbox{\tt in}  & {\em halopartid} & Array containing the ID of the particles belonging to the halos\\
\hline
\mbox{\tt in}  & {\em halomass} & Array containing the mass of the halos\\
\hline
\mbox{\tt in}  & {\em halopartvel} & Array containing the position and velocity of the particles belonging to the halos\\
\hline
\mbox{\tt in}  & {\em halopartpot} & Array containing the potential of the particles belonging to the halos, this argument is optional\\
\hline
\mbox{\tt in}  & {\em halopartfor} & Array containing the force on the particles belonging to the halos, this argument is optional\\
\hline
\mbox{\tt in}  & {\em halopartramsesid} & Array containing the \char`\"{}\+Ramses\char`\"{} ID of the particles belonging to the halos detected in lightcones \\
\hline
\end{DoxyParams}


Definition at line 219 of file modwritehalo.\+f90.



References modmpicom\+::commcolorwrite, modiocommons\+::h5write\+\_\+meta\+\_\+common(), modiocommons\+::h5write\+\_\+meta\+\_\+info\+\_\+cone(), modiocommons\+::h5write\+\_\+meta\+\_\+info\+\_\+ramses(), modiocommons\+::h5write\+\_\+meta\+\_\+pfof\+\_\+parameter(), modhdf5\+::hdf5\+\_\+close\+\_\+group(), modhdf5\+::hdf5\+\_\+close\+\_\+mpi\+\_\+file(), modhdf5\+::hdf5\+\_\+create\+\_\+group(), modhdf5\+::hdf5\+\_\+create\+\_\+mpi\+\_\+file(), modhdf5\+::hdf5\+\_\+open\+\_\+group(), modmpicom\+::mpierr, modmpicom\+::procid, and modmpicom\+::scprocidwrite.



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemodwritehalo_a7de4785bb81feb8a4b806bd18a65bf4d_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemodwritehalo_a7de4785bb81feb8a4b806bd18a65bf4d_icgraph}
\end{center}
\end{figure}


